@* Areas/Admin/Views/Orders/Delete.cshtml *@

@model BookShop.Models.Order

@{
    ViewData["Title"] = "Delete Order";
}

<div class="container">
    <h1 class="mb-4">Delete Order</h1>

    <div class="alert alert-danger">
        <h4 class="alert-heading">
            <i class="bi bi-exclamation-triangle-fill"></i>
            Are you sure you want to delete this order?
        </h4>
        <p>This action cannot be undone. All order data will be permanently removed from the system.</p>
        <hr>
        <p class="mb-0">
            <strong>Note:</strong> Deleting this order will remove it from sales reports and customer order history.
        </p>
    </div>

    <div class="row">
        <div class="col-md-8">
            <!-- Order Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Order Information</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-3">Order ID</dt>
                        <dd class="col-sm-9">
                            <strong class="text-primary">#@Model.OrderId</strong>
                        </dd>

                        <dt class="col-sm-3">Order Date</dt>
                        <dd class="col-sm-9">@Model.OrderDate.ToString("MMMM dd, yyyy 'at' hh:mm tt")</dd>

                        <dt class="col-sm-3">Customer</dt>
                        <dd class="col-sm-9">
                            <strong>@Model.User.Name @Model.User.LastName</strong><br>
                            <small class="text-muted">@Model.User.Email</small>
                        </dd>

                        <dt class="col-sm-3">Product</dt>
                        <dd class="col-sm-9">
                            <strong>@Model.Product.Title</strong><br>
                            <small class="text-muted">by @Model.Product.Author.Name @Model.Product.Author.LastName</small>
                        </dd>

                        <dt class="col-sm-3">Quantity</dt>
                        <dd class="col-sm-9">@Model.Amount</dd>

                        <dt class="col-sm-3">Unit Price</dt>
                        <dd class="col-sm-9">$@Model.Product.Price.ToString("0.00")</dd>

                        <dt class="col-sm-3">Total Price</dt>
                        <dd class="col-sm-9">
                            <strong class="text-success">$@Model.TotalPrice.ToString("0.00")</strong>
                        </dd>

                        <dt class="col-sm-3">Delivery Address</dt>
                        <dd class="col-sm-9">
                            <address>
                                @Model.DeliveryAddress
                            </address>
                        </dd>
                    </dl>
                </div>
            </div>

            <!-- Confirmation Form -->
            <div class="card">
                <div class="card-body">
                    <form asp-action="Delete" method="post">
                        <input type="hidden" asp-for="OrderId" />

                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">Confirm Deletion</h6>
                                <small class="text-muted">
                                    This will permanently delete Order #@Model.OrderId
                                </small>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="submit" class="btn btn-danger">
                                    <i class="bi bi-trash"></i>
                                    Delete Order
                                </button>
                                <a asp-action="Details" asp-route-id="@Model.OrderId" class="btn btn-info">
                                    <i class="bi bi-eye"></i>
                                    Back to Details
                                </a>
                                <a asp-action="Index" class="btn btn-secondary">
                                    <i class="bi bi-list"></i>
                                    Back to Orders
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Order Summary Card -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Order Summary</h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        @if (!string.IsNullOrEmpty(Model.Product.ImageName) && Model.Product.ImageName != "noimage.png")
                        {
                            <img src="~/images/covers/@Model.Product.ImageName" alt="@Model.Product.Title" class="img-fluid rounded" style="max-height: 120px;">
                        }
                        else
                        {
                            <img src="~/images/covers/noimage.png" alt="No Image" class="img-fluid rounded" style="max-height: 120px;">
                        }
                    </div>

                    <h6 class="text-center">@Model.Product.Title</h6>
                    <p class="text-center text-muted small">by @Model.Product.Author.Name @Model.Product.Author.LastName</p>

                    <div class="bg-light p-3 rounded">
                        <div class="d-flex justify-content-between small">
                            <span>Unit Price:</span>
                            <span>$@Model.Product.Price.ToString("0.00")</span>
                        </div>
                        <div class="d-flex justify-content-between small">
                            <span>Quantity:</span>
                            <span>×@Model.Amount</span>
                        </div>
                        <hr class="my-2">
                        <div class="d-flex justify-content-between">
                            <strong>Total:</strong>
                            <strong class="text-success">$@Model.TotalPrice.ToString("0.00")</strong>
                        </div>
                    </div>

                    <div class="mt-3">
                        <small class="text-muted">
                            <i class="bi bi-calendar3"></i>
                            Ordered on @Model.OrderDate.ToString("MMM dd, yyyy")
                        </small>
                    </div>
                </div>
            </div>

            <!-- Impact Warning -->
            <div class="card mt-3 border-warning">
                <div class="card-header bg-warning bg-opacity-10">
                    <h6 class="mb-0">
                        <i class="bi bi-exclamation-triangle text-warning"></i>
                        Deletion Impact
                    </h6>
                </div>
                <div class="card-body">
                    <ul class="small mb-0">
                        <li>Order will be removed from all reports</li>
                        <li>Customer's order history will be updated</li>
                        <li>Sales statistics will be recalculated</li>
                        <li>This action cannot be undone</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <!-- Add Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

    <script>
        // Add confirmation dialog for extra safety
        document.querySelector('form').addEventListener('submit', function(e) {
            if (!confirm('Are you absolutely sure you want to delete Order #@Model.OrderId? This action cannot be undone.')) {
                e.preventDefault();
            }
        });
    </script>
}